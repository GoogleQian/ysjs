webpackJsonp([29],{E9jT:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e("Dd8w"),s=e.n(r),n=e("Xxa5"),i=e.n(n),o=e("exGp"),l=e.n(o),c=e("8LkZ"),d=e("E4OE"),u=e("0N3M");var v={tooltip:{show:!0},xAxis:{type:"category",data:[],axisLabel:{rotate:30}},yAxis:{type:"value"},series:[{data:[],type:"bar",barWidth:"50px"}]},p={title:{show:!0,text:"水量类型"},grid:{left:"3%",right:"4%",top:"3%",bottom:"10%",containerLabel:!0},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"right",data:["大杯","中杯","小杯"]},series:[{name:"用户用水类型",type:"pie",radius:"80%",data:[{value:0,name:"大杯"},{value:0,name:"中杯"},{value:0,name:"小杯"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],color:["#91c7ae","#d48265","#E6A23C"]},m={},y={data:function(){return{barTyp:"订单数量排行",total:"day",devOptions:v,typeOptions:p,dataOverview:m,queryParams:{type:1,devNo:"",startTime:null,endTime:null},rankParams:{type:1,startTime:null,endTime:null},devList:[],dataRank:{}}},created:function(){var t=this;return l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.getDevList();case 2:return t.getData(),a.next=5,t.getRankData();case 5:t.devOptions.xAxis.data=t.dataRank.devNo||[],t.devOptions.series[0].data=t.dataRank.order||[];case 7:case"end":return a.stop()}},a,t)}))()},components:{Chart:d.a,CountTo:c.a},methods:{querySearch:function(t,a){var e=this;return l()(i.a.mark(function r(){var s,n;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getDevList();case 2:s=e.devList.map(function(t){return{value:t.device_id}}),console.log(s),n=t?s.filter(e.createFilter(t)):s,a(n);case 6:case"end":return r.stop()}},r,e)}))()},createFilter:function(t){return function(a){return 0===a.value.toLowerCase().indexOf(t.toLowerCase())}},changeTotal:function(){},renderChart:function(t){"订单数量排行"===t?this.devOptions.series[0].data=this.dataRank.order||[]:"销售金额排行"===t?this.devOptions.series[0].data=this.dataRank.money||[]:"售水量排行"===t&&(this.devOptions.series[0].data=this.dataRank.water||[])},getData:function(){var t=this;return l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(e=s()({},t.queryParams),Object(u.a)({url:"/consumeInfo/consume",method:"get",params:e})).then(function(a){var e=a.data.datas||{};t.dataOverview=e.consumeInfo||{};var r=e.cup||{cupAmount:[{name:null,value:0}],cupName:[null]};console.log(e.cup),t.typeOptions.series[0].data=r.cupAmount||0,t.typeOptions.legend.data=r.cupName||0});case 2:case"end":return a.stop()}var e},a,t)}))()},getDevList:function(){var t=this;return l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(e=void 0,Object(u.a)({url:"/device/ownDev",method:"get",params:e})).then(function(a){t.devList=a.data.datas,t.queryParams.devNo=t.devList[0].device_id});case 2:case"end":return a.stop()}var e},a,t)}))()},getRankData:function(){var t=this;return l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(e=s()({},t.rankParams),Object(u.a)({url:"/consumeInfo/rank",method:"get",params:e})).then(function(a){t.dataRank=a.data.datas.cup,t.renderChart(t.barTyp)});case 2:case"end":return a.stop()}var e},a,t)}))()}}},f={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"statistics"},[e("div",{staticClass:"total"},[e("el-card",{staticClass:"top-border"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("设备：")]),t._v(" "),e("el-select",{attrs:{filterable:""},model:{value:t.queryParams.devNo,callback:function(a){t.$set(t.queryParams,"devNo",a)},expression:"queryParams.devNo"}},t._l(t.devList,function(t){return e("el-option",{key:t.device_id,attrs:{value:t.device_id,label:t.device_id}})})),t._v(" "),e("span",[t._v("时间段")]),t._v(" "),e("el-select",{model:{value:t.queryParams.type,callback:function(a){t.$set(t.queryParams,"type",a)},expression:"queryParams.type"}},[e("el-option",{attrs:{value:1,label:"当日"}}),t._v(" "),e("el-option",{attrs:{value:2,label:"最近七天"}}),t._v(" "),e("el-option",{attrs:{value:3,label:"最近一月"}}),t._v(" "),e("el-option",{attrs:{value:0,label:"自定义查询日期"}})],1),t._v(" "),e("el-date-picker",{attrs:{disabled:0!==t.queryParams.type,"value-format":"yyyy-MM-dd",type:"date",placeholder:"开始时间"},model:{value:t.queryParams.startTime,callback:function(a){t.$set(t.queryParams,"startTime",a)},expression:"queryParams.startTime"}}),t._v(" "),e("el-date-picker",{attrs:{disabled:0!==t.queryParams.type,"value-format":"yyyy-MM-dd",type:"date",placeholder:"结束时间"},model:{value:t.queryParams.endTime,callback:function(a){t.$set(t.queryParams,"endTime",a)},expression:"queryParams.endTime"}}),t._v(" "),e("el-button",{on:{click:t.getData}},[t._v("查看")])],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{staticClass:"box1",attrs:{span:15}},[e("div",{staticClass:"item",staticStyle:{background:"#2d8cf0"}},[e("div",{staticClass:"left"},[e("count-to",{staticClass:"count",attrs:{decimals:0,end:Number(t.dataOverview.usageCount)||0}},[e("span",[t._v("  ")])]),t._v(" "),e("div",{staticClass:"item-name"},[t._v("\n                订单数\n              ")])],1),t._v(" "),e("div",{staticClass:"right"},[e("i",{staticClass:"iconfont icon-dingdanguanli-"})])]),t._v(" "),e("div",{staticClass:"item",staticStyle:{background:"#19be6b"}},[e("div",{staticClass:"left"},[e("count-to",{staticClass:"count",attrs:{decimals:2,end:Number(t.dataOverview.moneyAmount)||0}},[e("span",[t._v("元")])]),t._v(" "),e("div",{staticClass:"item-name"},[t._v("\n                订单总额\n              ")])],1),t._v(" "),e("div",{staticClass:"right"},[e("i",{staticClass:"iconfont icon-qian"})])]),t._v(" "),e("div",{staticClass:"item",staticStyle:{background:"#ed3f14"}},[e("div",{staticClass:"left"},[e("count-to",{staticClass:"count",attrs:{decimals:2,end:Number(t.dataOverview.waterAmount)||0}},[e("span",[t._v("升")])]),t._v(" "),e("div",{staticClass:"item-name"},[t._v("\n                累计售水量\n              ")])],1),t._v(" "),e("div",{staticClass:"right"},[e("i",{staticClass:"iconfont icon-leijishuiliang"})])])]),t._v(" "),e("el-col",{staticStyle:{height:"300px","border-left":"1px solid #cecece"},attrs:{span:8}},[e("Chart",{attrs:{size:["100%","100%"],watchShallow:!1,options:t.typeOptions}})],1)],1)],1),t._v(" "),e("el-card",{staticClass:"top-border",staticStyle:{"margin-top":"10px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("销售排行")]),t._v(" "),e("el-select",{model:{value:t.rankParams.type,callback:function(a){t.$set(t.rankParams,"type",a)},expression:"rankParams.type"}},[e("el-option",{attrs:{value:1,label:"当日"}}),t._v(" "),e("el-option",{attrs:{value:2,label:"最近七天"}}),t._v(" "),e("el-option",{attrs:{value:3,label:"最近一月"}}),t._v(" "),e("el-option",{attrs:{value:0,label:"自定义查询日期"}})],1),t._v(" "),e("el-date-picker",{attrs:{disabled:0!==t.rankParams.type,"value-format":"yyyy-MM-dd",type:"date",placeholder:"开始时间"},model:{value:t.rankParams.startTime,callback:function(a){t.$set(t.rankParams,"startTime",a)},expression:"rankParams.startTime"}}),t._v(" "),e("el-date-picker",{attrs:{disabled:0!==t.rankParams.type,"value-format":"yyyy-MM-dd",type:"date",placeholder:"结束时间"},model:{value:t.rankParams.endTime,callback:function(a){t.$set(t.rankParams,"endTime",a)},expression:"rankParams.endTime"}}),t._v(" "),e("el-button",{on:{click:t.getRankData}},[t._v("查看")])],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-radio-group",{on:{change:t.renderChart},model:{value:t.barTyp,callback:function(a){t.barTyp=a},expression:"barTyp"}},[e("el-radio-button",{attrs:{label:"订单数量排行"}}),t._v(" "),e("el-radio-button",{attrs:{label:"销售金额排行"}}),t._v(" "),e("el-radio-button",{attrs:{label:"售水量排行"}})],1),t._v(" "),e("el-col",{staticClass:"bar",attrs:{span:24}},[e("Chart",{attrs:{size:["100%","100%"],watchShallow:!1,options:t.devOptions}})],1)],1)],1)],1)])},staticRenderFns:[]};var b=e("VU/8")(y,f,!1,function(t){e("w7pW")},"data-v-8b16b3ec",null);a.default=b.exports},w7pW:function(t,a){}});