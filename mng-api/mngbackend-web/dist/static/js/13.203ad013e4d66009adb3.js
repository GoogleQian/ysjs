webpackJsonp([13,49],{NnDa:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={props:{tableData:{type:Array,default:function(){return[{}]}},total:{default:0,type:Number},selectedIds:{type:Array,default:function(){return[]}}},data:function(){return{currentPage:1}},methods:{toggleSelection:function(){var e=this,t=[];(t=this.tableData.filter(function(t){return e.selectedIds.includes(t.id)}))?t.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e;var t=this.multipleSelection.map(function(e){return e.id});this.$emit("selectionChange",t)},handleCurrentChange:function(e){this.currentPage=e,this.$emit("currentChange",e)}},beforeDestroy:function(){console.log("destory"),this.$refs.multipleTable.clearSelection()}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"devList"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark","max-height":"300",border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"Id",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"device_id",label:"设备编号","show-overflow-tooltip":""}})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.currentPage,"page-size":10,layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)},staticRenderFns:[]};var l=a("VU/8")(i,n,!1,function(e){a("pjba")},null,null);t.default=l.exports},USor:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Gu7T"),n=a.n(i),l=a("Xxa5"),r=a.n(l),s=a("exGp"),o=a.n(s),d=a("Dd8w"),c=a.n(d),u=a("VjnB"),g=a("axK0"),p=a("NnDa"),h=a("0N3M");function m(e){var t=e.id,a=e.params;return Object(h.a)({url:"/repairers/devBind/"+t,method:"get",params:a})}function f(e){var t=e.id,a=e.params;return Object(h.a)({url:"/repairers/dev/"+t,method:"get",params:a})}var v=[{label:"姓名",value:"realName",type:"input",placeholder:"姓名"}],b=[{label:"维修员姓名",value:"realName"},{label:"手机号",value:"phone"},{label:"登录名",value:"loginName"}],D={data:function(){return{tableData:[],page:{total:0,currentPage:1},tableColumns:b,searchItems:v,tableLoading:!1,btnLoading:!1,searchForm:{},dialogTitle:"新增",dialogVisible:!1,labelWidth:"100px",dialogData:{schemalist:[]},allDev:[],devDialogData:{roleIdList:[]},devDialog:{title:"分配设备",visible:!1},allUnbindDev:[],total:0,selectedIds:[],ids:null,id:null}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.tableLoading=!0;var t,a=c()({page:this.page.currentPage},this.searchForm);(t=a,Object(h.a)({url:"/repairers",method:"post",data:t})).then(function(t){e.tableLoading=!1,e.tableData=t.data.datas.list,e.page.total=t.data.datas.itemCounts})},search:function(e){this.page.currentPage=1,this.searchForm=e,this.getList()},func:function(e){var t=e.opera,a=e.row;switch(t){case"修改":this.edit(a);break;case"新增":this.add();break;case"删除":this.del(a);break;case"分配设备":this.setDev(a)}},add:function(){this.dialogTitle="新增",this.dialogData={},this.dialogVisible=!0},edit:function(e){this.dialogTitle="编辑",this.dialogData=c()({},e),this.dialogVisible=!0},del:function(e){var t=this;this.$confirm("此操作将永久删除所选数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a,i;(a={id:e.id},i=a.id,Object(h.a)({url:"/repairers/"+i,method:"delete"})).then(function(e){t.$message({message:0===e.data.ret?"删除成功":e.data.msg,type:0===e.data.ret?"success":"error"}),t.getList()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},currentChange:function(e){this.currentPage=e,this.devDialogData.params.page=e,this.getAllDev(this.devDialogData)},selectionChange:function(e){this.ids=e},handleCurrentChange:function(e){this.page.currentPage=e,this.getList()},getRepairDev:function(e){var t=this;return o()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f(e).then(function(e){e.data.datas.list&&(t.selectedIds=e.data.datas.list.map(function(e){return e.id}))});case 2:case"end":return a.stop()}},a,t)}))()},getAllDev:function(e){var t=this;return o()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m(e).then(function(e){0===e.data.ret&&(t.allUnbindDev=e.data.datas.list,t.total=e.data.datas.itemCounts)});case 2:case"end":return a.stop()}},a,t)}))()},setDev:function(e){var t=this;return o()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.currentPage=1,t.devDialogData={roleIdList:[]},t.devDialog.visible=!0,t.id=null,t.ids=null,t.id=e.id,a.next=8,t.getRepairDev({id:e.id,params:{page:1,pageSize:999}});case 8:return t.devDialogData={id:e.id,params:{page:1}},a.next=11,t.getAllDev(t.devDialogData);case 11:t.$refs["dev-list"].toggleSelection();case 12:case"end":return a.stop()}},a,t)}))()},submitDev:function(){var e,t,a,i=this;(e={repairId:this.id,params:{devIds:[].concat(n()(this.ids)).join(",")}},t=e.repairId,a=e.params,Object(h.a)({url:"dev/allotRepairer/"+t,method:"get",params:a})).then(function(e){0===e.data.ret?(i.$message({message:"分配成功",type:"success"}),i.devDialog.visible=!1):i.$message({type:"error",message:e.data.msg})})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a,i,n,l=t.dialogData;"编辑"===t.dialogTitle?(a={id:t.dialogData.id,data:c()({},t.dialogData)},i=a.id,n=a.data,Object(h.a)({url:"/repairers/"+i,method:"put",data:n})).then(function(e){0==e.data.ret?(t.$message({message:"修改成功",type:"success"}),t.dialogVisible=!1,t.getList()):t.$message({message:e.data.msg,type:"error"})}):"新增"===t.dialogTitle&&function(e){return Object(h.a)({url:"/repairers/",method:"post",data:e})}(l).then(function(e){0==e.data.ret?(t.$message({message:"新增成功",type:"success"}),t.dialogVisible=!1,t.getList()):t.$message({message:e.data.msg,type:"error"})})})}},computed:{funcs:function(){return this.$store.state.user.funcs}},components:{ZTable:u.a,ZSearch:g.a,DevList:p.default}},C={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("z-search",{attrs:{searchItems:e.searchItems},on:{search:e.search}}),e._v(" "),a("z-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{tableData:e.tableData,tableColumns:e.tableColumns,page:e.page,funcs:e.funcs},on:{func:e.func,handleCurrentChange:e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.dialogData,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"维修员姓名:",prop:"realName"}},[a("el-input",{model:{value:e.dialogData.realName,callback:function(t){e.$set(e.dialogData,"realName",t)},expression:"dialogData.realName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号:",prop:"phone"}},[a("el-input",{model:{value:e.dialogData.phone,callback:function(t){e.$set(e.dialogData,"phone",t)},expression:"dialogData.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登录名:",prop:"loginName"}},[a("el-input",{model:{value:e.dialogData.loginName,callback:function(t){e.$set(e.dialogData,"loginName",t)},expression:"dialogData.loginName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码:",prop:"pwd"}},[a("el-input",{model:{value:e.dialogData.pwd,callback:function(t){e.$set(e.dialogData,"pwd",t)},expression:"dialogData.pwd"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.devDialog.title,visible:e.devDialog.visible},on:{"update:visible":function(t){e.$set(e.devDialog,"visible",t)}}},[a("dev-list",{ref:"dev-list",attrs:{tableData:e.allUnbindDev,total:e.total,selectedIds:e.selectedIds},on:{currentChange:e.currentChange,selectionChange:e.selectionChange}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.devDialog.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){e.submitDev("devForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var y=a("VU/8")(D,C,!1,function(e){a("Zrej")},"data-v-194d5c1f",null);t.default=y.exports},Zrej:function(e,t){},pjba:function(e,t){}});